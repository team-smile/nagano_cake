<h1>注文履歴詳細</h1>

<table>
  <tbody>
      <tr>
        <td>購入者</td>
        <td>
          <%= link_to admin_end_user_path(@order) do %>
            <%= @order.customer.last_name %>  <%= @order.customer.first_name %>
          <% end %>
        </td>
      <tr>
      <tr>
        <td>配送先</td>
        <td><%= @order.address %></td>
      <tr>
    　<tr>
        <td>支払方法</td>
        <td><%= @order.payment_method %></td>
      <tr>
    　<tr>
        <td>支払ステータス</td>
        <td>
          <%= form_with model:@order, url:admin_order_path(@order) ,local: true do |f| %>
            <%= f.select(:status, {入金待ち: '入金待ち', 入金確認: '入金確認', 制作中: '制作中', 発送準備中: '発送準備中', 発送済み: '発送済み'}) %>
            <%= f.submit "更新" %>
          <% end %>
        </td>
      <tr>
           
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <td>商品名</td>
      <td>単価(税込)</td>
      <td>数量</td>
      <td>小計</td>
      <td>制作ステータス</td>
    </tr>
  </thead>
  <% @order_details.each do |order_detail| %>
  <tbody>
    <tr>
      <td><%= order_detail.item.name %></td>
      <td><%= order_detail.price.to_s(:delimited) %></td>
      <td><%= order_detail.amount %></td>
      <td><%= (order_detail.price * order_detail.amount).to_s(:delimited) %></td>
      <td>
         <%= form_with model:order_detail, url: admin_order_order_detail_path(@order, order_detail), local: true do |f| %>
           <%= f.select(:making_status, {制作不可: '制作不可', 制作待ち: '制作待ち', 制作中: '制作中', 制作完了: '制作完了'}) %>
           <%= f.submit "更新" %>
         <% end %>
      </td>
    </tr>
  </tbody>
  <% end %>
</table>

<table>
  <tbody>
    <tr>
      <td>商品合計</td>
      <td>
          <%= @sum.to_s(:delimited) %>
      </td>
    </tr>
    <tr>
      <td>送料</td>
      <td><%= @order.postage %></td>
    </tr>
    <tr>
      <td>請求金額合計</td>
      <td><%= (@sum + @order.postage).to_s(:delimited) %></td>
    </tr>
  </tbody>
</table>